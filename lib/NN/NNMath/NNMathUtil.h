#pragma once
#ifndef NN_MATH_UTIL_H
#define NN_MATH_UTIL_H
#include <stdint.h>

// from arm_nn_types.h:
/** Enum for specifying activation function types */
typedef enum
{
    ARM_SIGMOID = 0, /**< Sigmoid activation function */
    ARM_TANH = 1,    /**< Tanh activation function */
} arm_nn_activation_type;



// from arm_nn_tables.h/.c:
/**
 * @brief tables for various activation functions
 *
 * This file include the declaration of common tables.
 * Most of them are used for activation functions
 *
 */

// Table of sigmoid(i/24) at 0.16 format - 256 elements.
// Combined sigmoid and tanh look-up table, since
// tanh(x) = 2*sigmoid(2*x) -1.
// Both functions are symmetric, so the LUT table is only needed
// for the absolute value of the input.
const uint16_t sigmoid_table_uint16[256] = {
    32768, 33451, 34133, 34813, 35493, 36169, 36843, 37513, 38180, 38841, 39498, 40149, 40794, 41432, 42064, 42688,
    43304, 43912, 44511, 45102, 45683, 46255, 46817, 47369, 47911, 48443, 48964, 49475, 49975, 50464, 50942, 51409,
    51865, 52311, 52745, 53169, 53581, 53983, 54374, 54755, 55125, 55485, 55834, 56174, 56503, 56823, 57133, 57433,
    57724, 58007, 58280, 58544, 58800, 59048, 59288, 59519, 59743, 59959, 60168, 60370, 60565, 60753, 60935, 61110,
    61279, 61441, 61599, 61750, 61896, 62036, 62172, 62302, 62428, 62549, 62666, 62778, 62886, 62990, 63090, 63186,
    63279, 63368, 63454, 63536, 63615, 63691, 63765, 63835, 63903, 63968, 64030, 64090, 64148, 64204, 64257, 64308,
    64357, 64405, 64450, 64494, 64536, 64576, 64614, 64652, 64687, 64721, 64754, 64786, 64816, 64845, 64873, 64900,
    64926, 64950, 64974, 64997, 65019, 65039, 65060, 65079, 65097, 65115, 65132, 65149, 65164, 65179, 65194, 65208,
    65221, 65234, 65246, 65258, 65269, 65280, 65291, 65301, 65310, 65319, 65328, 65337, 65345, 65352, 65360, 65367,
    65374, 65381, 65387, 65393, 65399, 65404, 65410, 65415, 65420, 65425, 65429, 65433, 65438, 65442, 65445, 65449,
    65453, 65456, 65459, 65462, 65465, 65468, 65471, 65474, 65476, 65479, 65481, 65483, 65485, 65488, 65489, 65491,
    65493, 65495, 65497, 65498, 65500, 65501, 65503, 65504, 65505, 65507, 65508, 65509, 65510, 65511, 65512, 65513,
    65514, 65515, 65516, 65517, 65517, 65518, 65519, 65520, 65520, 65521, 65522, 65522, 65523, 65523, 65524, 65524,
    65525, 65525, 65526, 65526, 65526, 65527, 65527, 65528, 65528, 65528, 65529, 65529, 65529, 65529, 65530, 65530,
    65530, 65530, 65531, 65531, 65531, 65531, 65531, 65532, 65532, 65532, 65532, 65532, 65532, 65533, 65533, 65533,
    65533, 65533, 65533, 65533, 65533, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 65534, 65535
};

// created for using 24bit values
const uint32_t sigmoid_table_uint24[1024] = {
    8388608, 8432175, 8475741, 8519302, 8562855, 8606400, 8649932, 8693451, 8736953, 8780436, 8823899, 8867337, 8910750, 8954136, 8997490, 9040812, 9084099, 9127349, 9170559, 9213727, 9256852, 9299930, 9342959, 9385938, 9428863, 9471733, 9514546, 9557299, 9599991, 9642618, 9685179, 9727672, 9770095, 9812445, 9854720, 9896919, 9939039, 9981078, 10023034, 10064906, 10106691, 10148386, 10189992, 10231504, 10272922, 10314243, 10355466, 10396589, 10437609, 10478526, 10519337, 10560040, 10600634, 10641117, 10681487, 10721743, 10761882, 10801904, 10841806, 10881588, 10921247, 10960781, 11000190, 11039471, 11078624, 11117647, 11156538, 11195296, 11233919, 11272407, 11310758, 11348970, 11387042, 11424973, 11462761, 11500406, 11537907, 11575261, 11612468, 11649527, 11686437, 11723196, 11759804, 11796259, 11832561, 11868709, 11904700, 11940536, 11976214, 12011734, 12047095, 12082297, 12117337, 12152216, 12186933, 12221488, 12255878, 12290104, 12324166, 12358061, 12391791, 12425354, 12458749, 12491976, 12525035, 12557926, 12590646, 12623197, 12655578, 12687788, 12719827, 12751695, 12783391, 12814915, 12846267, 12877446, 12908452, 12939285, 12969945, 13000432, 13030745, 13060884, 13090849, 13120641, 13150258, 13179701, 13208970, 13238065, 13266986, 13295732, 13324304, 13352703, 13380927, 13408977, 13436853, 13464556, 13492085, 13519441, 13546623, 13573633, 13600469, 13627133, 13653625, 13679944, 13706092, 13732067, 13757872, 13783505, 13808968, 13834261, 13859383, 13884336, 13909120, 13933735, 13958181, 13982460, 14006571, 14030514, 14054291, 14077902, 14101347, 14124627, 14147742, 14170693, 14193480, 14216103, 14238564, 14260863, 14283001, 14304977, 14326793, 14348450, 14369947, 14391285, 14412465, 14433488, 14454354, 14475064, 14495619, 14516019, 14536264, 14556356, 14576295, 14596082, 14615717, 14635202, 14654536, 14673721, 14692757, 14711646, 14730386, 14748981, 14767429, 14785733, 14803891, 14821907, 14839779, 14857509, 14875097, 14892545, 14909853, 14927022, 14944052, 14960945, 14977701, 14994320, 15010804, 15027154, 15043369, 15059452, 15075402, 15091221, 15106909, 15122467, 15137896, 15153197, 15168369, 15183415, 15198335, 15213130, 15227800, 15242346, 15256770, 15271071, 15285251, 15299311, 15313250, 15327071, 15340773, 15354358, 15367826, 15381179, 15394416, 15407539, 15420548, 15433445, 15446229, 15458902, 15471465, 15483918, 15496262, 15508498, 15520627, 15532649, 15544565, 15556376, 15568083, 15579686, 15591186, 15602584, 15613880, 15625076, 15636172, 15647169, 15658068, 15668869, 15679573, 15690181, 15700693, 15711111, 15721434, 15731664, 15741802, 15751848, 15761802, 15771666, 15781441, 15791126, 15800723, 15810232, 15819654, 15828990, 15838240, 15847406, 15856487, 15865484, 15874399, 15883231, 15891982, 15900652, 15909241, 15917751, 15926182, 15934535, 15942810, 15951008, 15959129, 15967175, 15975145, 15983041, 15990863, 15998612, 16006288, 16013892, 16021425, 16028887, 16036278, 16043600, 16050853, 16058037, 16065154, 16072203, 16079185, 16086101, 16092951, 16099737, 16106458, 16113115, 16119709, 16126239, 16132708, 16139115, 16145460, 16151745, 16157970, 16164136, 16170242, 16176289, 16182279, 16188211, 16194086, 16199905, 16205667, 16211374, 16217026, 16222624, 16228167, 16233657, 16239094, 16244478, 16249810, 16255091, 16260320, 16265498, 16270627, 16275705, 16280734, 16285714, 16290646, 16295530, 16300366, 16305155, 16309897, 16314593, 16319243, 16323848, 16328408, 16332923, 16337393, 16341820, 16346204, 16350545, 16354843, 16359099, 16363313, 16367486, 16371617, 16375708, 16379759, 16383770, 16387741, 16391673, 16395567, 16399422, 16403239, 16407018, 16410760, 16414465, 16418133, 16421765, 16425362, 16428922, 16432447, 16435937, 16439393, 16442815, 16446202, 16449556, 16452876, 16456164, 16459418, 16462641, 16465831, 16468990, 16472117, 16475213, 16478278, 16481313, 16484317, 16487292, 16490237, 16493152, 16496038, 16498896, 16501724, 16504525, 16507298, 16510042, 16512760, 16515450, 16518113, 16520750, 16523360, 16525944, 16528502, 16531034, 16533541, 16536023, 16538480, 16540912, 16543320, 16545704, 16548064, 16550400, 16552712, 16555001, 16557267, 16559511, 16561732, 16563930, 16566106, 16568261, 16570393, 16572504, 16574594, 16576663, 16578711, 16580738, 16582745, 16584732, 16586698, 16588645, 16590572, 16592479, 16594367, 16596237, 16598087, 16599918, 16601731, 16603526, 16605302, 16607061, 16608801, 16610525, 16612230, 16613918, 16615590, 16617244, 16618881, 16620502, 16622107, 16623695, 16625267, 16626823, 16628363, 16629888, 16631397, 16632891, 16634370, 16635834, 16637282, 16638716, 16640136, 16641541, 16642932, 16644308, 16645671, 16647020, 16648355, 16649676, 16650984, 16652279, 16653561, 16654829, 16656085, 16657328, 16658558, 16659775, 16660980, 16662173, 16663354, 16664523, 16665680, 16666825, 16667958, 16669080, 16670190, 16671289, 16672377, 16673453, 16674519, 16675574, 16676618, 16677651, 16678674, 16679686, 16680689, 16681680, 16682662, 16683634, 16684595, 16685547, 16686489, 16687422, 16688345, 16689258, 16690163, 16691058, 16691943, 16692820, 16693688, 16694547, 16695397, 16696238, 16697071, 16697895, 16698711, 16699519, 16700318, 16701109, 16701892, 16702667, 16703434, 16704193, 16704944, 16705688, 16706424, 16707152, 16707873, 16708587, 16709293, 16709992, 16710684, 16711369, 16712047, 16712718, 16713382, 16714039, 16714689, 16715333, 16715970, 16716601, 16717225, 16717843, 16718454, 16719059, 16719658, 16720251, 16720837, 16721418, 16721993, 16722561, 16723124, 16723682, 16724233, 16724779, 16725319, 16725854, 16726383, 16726907, 16727425, 16727938, 16728446, 16728948, 16729445, 16729938, 16730425, 16730907, 16731384, 16731857, 16732324, 16732787, 16733245, 16733698, 16734146, 16734590, 16735030, 16735465, 16735895, 16736321, 16736742, 16737160, 16737573, 16737981, 16738386, 16738786, 16739182, 16739574, 16739963, 16740347, 16740727, 16741103, 16741475, 16741844, 16742209, 16742570, 16742927, 16743281, 16743631, 16743977, 16744320, 16744659, 16744995, 16745327, 16745656, 16745982, 16746304, 16746623, 16746938, 16747250, 16747560, 16747865, 16748168, 16748468, 16748764, 16749058, 16749348, 16749636, 16749920, 16750202, 16750481, 16750757, 16751030, 16751300, 16751567, 16751832, 16752094, 16752353, 16752609, 16752863, 16753115, 16753363, 16753609, 16753853, 16754094, 16754333, 16754569, 16754803, 16755034, 16755263, 16755489, 16755714, 16755935, 16756155, 16756372, 16756588, 16756800, 16757011, 16757220, 16757426, 16757630, 16757832, 16758033, 16758231, 16758426, 16758620, 16758812, 16759002, 16759190, 16759376, 16759561, 16759743, 16759923, 16760102, 16760278, 16760453, 16760626, 16760797, 16760967, 16761135, 16761301, 16761465, 16761628, 16761789, 16761948, 16762105, 16762261, 16762416, 16762569, 16762720, 16762870, 16763018, 16763164, 16763309, 16763453, 16763595, 16763736, 16763875, 16764013, 16764149, 16764284, 16764417, 16764549, 16764680, 16764810, 16764938, 16765065, 16765190, 16765314, 16765437, 16765559, 16765679, 16765798, 16765916, 16766033, 16766148, 16766263, 16766376, 16766488, 16766598, 16766708, 16766817, 16766924, 16767030, 16767135, 16767239, 16767342, 16767444, 16767545, 16767645, 16767744, 16767842, 16767939, 16768034, 16768129, 16768223, 16768316, 16768408, 16768499, 16768589, 16768678, 16768766, 16768853, 16768940, 16769025, 16769110, 16769194, 16769276, 16769358, 16769440, 16769520, 16769599, 16769678, 16769756, 16769833, 16769909, 16769985, 16770059, 16770133, 16770206, 16770279, 16770350, 16770421, 16770492, 16770561, 16770630, 16770698, 16770765, 16770832, 16770898, 16770963, 16771027, 16771091, 16771155, 16771217, 16771279, 16771341, 16771401, 16771461, 16771521, 16771580, 16771638, 16771695, 16771752, 16771809, 16771865, 16771920, 16771975, 16772029, 16772082, 16772135, 16772188, 16772240, 16772291, 16772342, 16772392, 16772442, 16772492, 16772540, 16772589, 16772636, 16772684, 16772731, 16772777, 16772823, 16772868, 16772913, 16772957, 16773001, 16773045, 16773088, 16773131, 16773173, 16773215, 16773256, 16773297, 16773337, 16773377, 16773417, 16773456, 16773495, 16773534, 16773572, 16773609, 16773646, 16773683, 16773720, 16773756, 16773792, 16773827, 16773862, 16773897, 16773931, 16773965, 16773998, 16774032, 16774065, 16774097, 16774129, 16774161, 16774193, 16774224, 16774255, 16774285, 16774316, 16774346, 16774375, 16774405, 16774434, 16774462, 16774491, 16774519, 16774547, 16774574, 16774602, 16774629, 16774655, 16774682, 16774708, 16774734, 16774760, 16774785, 16774810, 16774835, 16774860, 16774884, 16774908, 16774932, 16774955, 16774979, 16775002, 16775025, 16775047, 16775070, 16775092, 16775114, 16775136, 16775157, 16775178, 16775199, 16775220, 16775241, 16775261, 16775281, 16775301, 16775321, 16775341, 16775360, 16775379, 16775398, 16775417, 16775436, 16775454, 16775472, 16775490, 16775508, 16775526, 16775543, 16775560, 16775577, 16775594, 16775611, 16775628, 16775644, 16775660, 16775676, 16775692, 16775708, 16775724, 16775739, 16775754, 16775769, 16775784, 16775799, 16775814, 16775828, 16775842, 16775857, 16775871, 16775885, 16775898, 16775912, 16775925, 16775939, 16775952, 16775965, 16775978, 16775991, 16776003, 16776016, 16776028, 16776041, 16776053, 16776065, 16776077, 16776088, 16776100, 16776111, 16776123, 16776134, 16776145, 16776156, 16776167, 16776178, 16776189, 16776199, 16776210, 16776220, 16776231, 16776241, 16776251, 16776261, 16776271, 16776280, 16776290, 16776300, 16776309, 16776318, 16776328, 16776337, 16776346, 16776355, 16776364, 16776373, 16776381, 16776390, 16776398, 16776407, 16776415, 16776424, 16776432, 16776440, 16776448, 16776456, 16776464, 16776471, 16776479, 16776487, 16776494, 16776502, 16776509, 16776516, 16776524, 16776531, 16776538, 16776545, 16776552, 16776558, 16776565, 16776572, 16776579, 16776585, 16776592, 16776598, 16776605, 16776611, 16776617, 16776623, 16776629, 16776635, 16776641, 16776647, 16776653, 16776659, 16776665, 16776670, 16776676, 16776682, 16776687, 16776693, 16776698, 16776703, 16776709, 16776714, 16776719, 16776724, 16776729, 16776734, 16776739, 16776744, 16776749, 16776754, 16776759, 16776763, 16776768, 16776773, 16776777, 16776782, 16776786, 16776791, 16776795, 16776799, 16776804, 16776808
};

#endif